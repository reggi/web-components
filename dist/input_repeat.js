var u=class extends HTMLElement{repeatCount;innerHTMLCache;name="";action="";method="";values=[];repeat=0;itemLength=0;observer;cacheSet=!1;namespace="input-repeat";get container(){return this.dataAttribute("container")}get newLine(){return this.dataAttribute("create-new-line")}get item(){return this.dataAttribute("item")}get selectorRemove(){return this.dataAttribute("remove")}get up(){return this.dataAttribute("up")}get down(){return this.dataAttribute("down")}constructor(){super(),this.repeatCount=0,this.innerHTMLCache=""}connectedCallback(){this.namespace=this.getAttribute("data-namespace")||"input-repeat",this.name=this.getAttribute("data-name")||"",this.values=JSON.parse(this.getAttribute("data-values")||"[]"),this.repeat=parseInt(this.getAttribute("data-repeat")||"0"),this.itemLength=Math.max(this.values.length,this.repeat),this.observer=new MutationObserver(()=>this.render()),this.observer.observe(this,{childList:!0,subtree:!0}),this.render()}disconnectedCallback(){this.observer&&this.observer.disconnect()}dataAttribute(e){let n=["data",this.namespace,e].join("-"),i=`[${n}]`;return{value:n,selector:i}}render(){if(this.cacheSet||this.innerHTMLCache===this.innerHTML)return;this.innerHTMLCache=this.innerHTML,this.cacheSet=!0,this.innerHTML=`<div ${this.container.value}></div>`,document.querySelector(this.newLine.selector)||(this.innerHTML+=`<button type="button" ${this.newLine.value}>Add New Line</button>`);let n=this.values;this.repeatCount=this.itemLength;for(let t=0;t<this.repeatCount;t++)this.addNewLine(n&&n[t]||{},t);this.repeatCount=n.length-1;let i=document.querySelector(this.newLine.selector);i&&i.addEventListener("click",()=>this.add())}addNewLine(e={},n){let i=this.querySelector(this.container.selector);if(!i)return;let t=document.createElement("div");t.setAttribute(this.item.value,"true");let r=document.createElement("div");r.innerHTML=this.innerHTMLCache,Object.entries(e).forEach(([a,o])=>{let c=`${this.name}[${n}][${a}]`,s=r.querySelector(`input[name="${a}"]`);s&&(s.setAttribute("value",o),s.setAttribute("name",c))}),r.querySelectorAll("input").forEach(a=>{if(a.value)return;let o=a.getAttribute("name"),c=`${this.name}[${n}][${o}]`,s=r.querySelector(`input[name="${o}"]`);s&&s.setAttribute("name",c)}),t.innerHTML=r.innerHTML,r.querySelector(this.selectorRemove.selector)||(t.innerHTML+=`<button ${this.selectorRemove.value}>Remove</button>`),r.querySelector(this.up.selector)||(t.innerHTML+=`<button ${this.up.value}>Up</button>`),r.querySelector(this.down.selector)||(t.innerHTML+=`<button ${this.down.value}>Down</button>`),t.querySelector(this.selectorRemove.selector)?.addEventListener("click",()=>this.removeElement(t)),t.querySelector(this.up.selector)?.addEventListener("click",()=>this.moveUp(t)),t.querySelector(this.down.selector)?.addEventListener("click",()=>this.moveDown(t)),i.appendChild(t)}add(){this.repeatCount=this.repeatCount+1,this.addNewLine({},this.repeatCount)}removeElement(e){e.remove(),this.repeatCount=this.repeatCount-1}moveUp(e){e===e.parentElement?.firstElementChild?e.parentElement.appendChild(e):e.parentElement?.insertBefore(e,e.previousElementSibling)}moveDown(e){e===e.parentElement?.lastElementChild?e.parentElement.insertBefore(e,e.parentElement.firstElementChild):e.nextElementSibling&&e.parentElement?.insertBefore(e.nextElementSibling,e)}};customElements.define("input-repeat",u);
